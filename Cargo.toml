# Ultralytics ðŸš€ AGPL-3.0 License - https://ultralytics.com/license

[package]
name = "inference"
version = "0.0.4"
edition = "2024"
authors = [
    "Glenn Jocher <glenn.jocher@ultralytics.com>",
    "Onuralp Sezer <onuralp@ultralytics.com>",
]
description = "Ultralytics YOLO inference library and CLI for Rust"
license = "AGPL-3.0"
repository = "https://github.com/ultralytics/inference"
readme = "README.md"
keywords = ["yolo", "ultralytics", "inference", "computer-vision", "ml"]
categories = ["computer-vision", "science", "command-line-interface", "wasm"]

[lints.rust]
unsafe_code = "warn"
missing_docs = "warn"

[lints.clippy]
all = "warn"
pedantic = "warn"
nursery = "warn"
cargo = "warn"

[lib]
name = "inference"
path = "src/lib.rs"

[[bin]]
name = "inference"
path = "src/main.rs"

[dependencies]
# Core - Image loading and processing
image = "^0.25"
jpeg-decoder = "^0.3"
fast_image_resize = { version = "^5.4", features = ["image", "rayon"] }

# Numerical computing (must match ort's ndarray version 0.17)
ndarray = { version = "^0.17", features = ["rayon"] }

# ONNX Runtime 1.23 - using latest from GitHub for best performance
ort = { git = "https://github.com/pykeio/ort.git", default-features = false, features = [
    "std",
    "ndarray",
    "download-binaries",
    "copy-dylibs",
    "half",
    "tls-native",
] }

# Core - FP16 support (required by ort's half feature)
half = { version = "^2.4", features = ["num-traits"] }
ureq = "^3.1.4"
dirs = "^6.0"
rayon = "^1.10"
bytemuck = { version = "^1.21", features = ["derive"] }

minifb = { version = "^0.28.0", optional = true }
video-rs = { version = "^0.10.5", features = ["ndarray"], optional = true }

# Optional - Image annotation (for --save feature)
imageproc = { version = "^0.25", optional = true }
ab_glyph = { version = "^0.2", optional = true }

# Optional - Video support
ffmpeg-next = { version = "^7.1.0", optional = true }
ffmpeg-sys-next = { version = "^7.1.3", optional = true }

[features]
default = ["annotate", "visualize"]

# Real-time visualization
visualize = ["minifb"]

# Video support
video = ["video-rs", "ffmpeg-next", "ffmpeg-sys-next"]

# Image annotation support (for --save feature in CLI)
annotate = ["imageproc", "ab_glyph"]

# NVIDIA GPU acceleration
cuda = ["ort/cuda"]
tensorrt = ["ort/tensorrt"]

# AMD GPU acceleration
rocm = ["ort/rocm"]

# Intel acceleration
openvino = ["ort/openvino"]
onednn = ["ort/onednn"]

# DirectML (Windows)
directml = ["ort/directml"]

# Mobile/Embedded
nnapi = ["ort/nnapi"]   # Android
coreml = ["ort/coreml"] # iOS/macOS
qnn = ["ort/qnn"]       # Qualcomm

# Additional accelerators
xnnpack = ["ort/xnnpack"]
acl = ["ort/acl"]           # ARM Compute Library
armnn = ["ort/armnn"]       # ARM NN
tvm = ["ort/tvm"]           # Apache TVM
migraphx = ["ort/migraphx"] # AMD MIGraphX
rknpu = ["ort/rknpu"]       # Rockchip NPU
vitis = ["ort/vitis"]       # Xilinx Vitis AI
cann = ["ort/cann"]         # Huawei CANN
webgpu = ["ort/webgpu"]     # WebGPU
azure = ["ort/azure"]       # Azure

# Convenience feature groups
nvidia = ["cuda", "tensorrt"]
amd = ["rocm", "migraphx"]
intel = ["openvino", "onednn"]
mobile = ["nnapi", "coreml", "qnn"]
all = [
    "annotate",
    "video",
    "cuda",
    "tensorrt",
    "rocm",
    "openvino",
    "onednn",
    "directml",
    "nnapi",
    "coreml",
    "xnnpack",
    "acl",
    "armnn",
    "tvm",
    "migraphx",
    "rknpu",
    "vitis",
    "cann",
    "qnn",
    "azure",
]

[dev-dependencies]
# Testing dependencies

[profile.release]
opt-level = 3
lto = true
codegen-units = 1
